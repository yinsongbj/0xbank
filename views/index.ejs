<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <script type="text/javascript" src="/js/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="/js/ethjs-util.js"></script>
    <script type="text/javascript" src="/js/ethjs-account.js"></script>
    <script type="text/javascript" src="/js/ethjs.js"></script>
	<script type="text/javascript">
		var stopFlag = true;
		function randomAddress(){
			var random = "";
			for (var i = 0; i <32; i++) {
				random += Math.round(Math.random() * 255).toString(16);
			}
			var obj = ethAccount.generate(random);
			console.log(obj);

			var params = {uid:1,address:obj.address, privateKey:obj.privateKey};
			url = '/balance/get';
			$.post(url,params,function(data){
			    console.log(data);
			    document.getElementById('address').innerText = data.address;
			    document.getElementById('balance').innerText = data.balance;
			    if(data.balance !== "0x0"){
			    	stopFlag = true;
			    }
			    if(!stopFlag){
			    	randomAddress();
			    }
			});
		}
		$(document).ready(function(){
			$("button#start").click(function(){
			    $("button#start").hide();
			    $("button#stop").show();
			    stopFlag= false;
			    randomAddress();
			});
			$("button#stop").click(function(){
			    stopFlag= true;
			    $("button#start").show();
			    $("button#stop").hide();
			});
			$("button#start").trigger("click");
		});

	</script>
  </head>
  <body>
    <h1><%= title %></h1>
    <p>Address</p>
    <p id="address">address</p>
    <p>Balance</p>
    <p id="balance">balance</p>
    <button id="start"> Start</button>
    <button id="stop"> Stop</button>
  </body>
</html>
